# pytorch_lightning==2.0.2
trainer:
  accelerator: gpu
  devices: 1
  logger:
    class_path: pytorch_lightning.loggers.CSVLogger
    init_args:
      save_dir: output/svgd_fixaug/
      name: clevrcount-r16-lr-0.8_tmux-[10]_sigma_0.1  
  max_epochs: 150
  val_check_interval: 50
  num_sanity_val_steps: 0
model:
  model_name: vit-b16-224-dino
  training_mode: lora
  optimizer: svgd
  lr: 0.8
  momentum: 0.9
  weight_decay: 0.0
  scheduler: cosine
  warmup_steps: 500
  rho: 0
  sigma: 1
  lora_r: 8
  lora_alpha: 8
  num_particles: 4
  cov_mat: True
  max_num_models: 20
  use_sam: False
  start_swa_step: 200
  swa_freq: 1
  use_swa_svgd: False
  use_sym_kl: False
data:
  train_aug: True
  dataset: clevrcount
  root: ../Z.Data/vtab-1k/clevr_count
  size: 224
  batch_size: 64
  workers: 4
model_checkpoint:
  dirpath: saved_checkpoints
  filename: best-step-{step}-{val_acc:.4f}
  monitor: val_acc
  mode: max
  save_last: true
